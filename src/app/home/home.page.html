<ion-header [translucent]="true">
  <ion-toolbar color="primary" class="">
    <ion-title class="pt-10 pb-10" size="large">
      Sell Price Calculator
    </ion-title>

    <ion-icon
      (click)="openProductsModal()"
      class="fz-35 color-white mr-5"
      name="reorder-four-outline"
      slot="end"
    ></ion-icon>
    <ion-icon
      (click)="openSettingsModal()"
      class="fz-35 color-white mr-5"
      name="cog-outline"
      slot="end"
    ></ion-icon>

    <ion-icon
      class="fz-35 color-white mr-5"
      (click)="changeLanguage()"
      slot="end"
      name="language-outline"
    ></ion-icon>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="flex justify-between m-10" *ngIf="sellingPrice > 0">
    <div *ngFor="let chartLabelColor of this.chartLabelColors">
      <div class="flex flex-column justify-center items-center">
        <div
          class="color-indicator"
          [ngStyle]="{'background-color':chartLabelColor.color}"
        ></div>
        <div>{{chartLabelColor.label | translate}}</div>
      </div>
    </div>
  </div>
  <div class="calculation-container">
    <div class="flex justify-center flex-column">
      <ion-card (click)="openSettingsModal()">
        <div class="p-5">
          <ion-label
            >{{ 'Savings' | translate }}: {{this.savingPercent}} %</ion-label
          >
        </div>

        <div class="p-5">
          <div class="flex justify-end">
            <ion-label
              >{{this.currencySymbol}} {{calcSaving.toFixed(2)}}
            </ion-label>
          </div>
        </div>
      </ion-card>

      <ion-card (click)="openSettingsModal()">
        <div class="p-5">
          <ion-label>{{'Tax' | translate}} : {{this.gstPercent}} %</ion-label>
        </div>

        <div class="p-5">
          <div class="flex justify-end">
            <ion-label
              >{{this.currencySymbol}} {{calcGST.toFixed(2)}}</ion-label
            >
          </div>
        </div>
      </ion-card>
      <ion-card class="sell-indicator">
        <div class="p-5">
          <ion-label class="color-white"
            >{{ 'Selling Price' | translate }}</ion-label
          >
        </div>

        <div class="p-5">
          <div class="flex justify-end">
            <ion-label class="color-white"
              >{{this.currencySymbol}} {{sellingPrice.toFixed(2)}}</ion-label
            >
          </div>
        </div>
      </ion-card>
    </div>
    <div class="flex justify-center flex-column">
      <div *ngIf="sellingPrice > 0">
        <canvas
          width="20"
          height="20"
          baseChart
          [data]="doughnutChartData"
          [labels]="doughnutChartLabels"
          [chartType]="doughnutChartType"
          [options]="doughnutChartOptions"
          [colors]="doughnutChartColors"
        >
        </canvas>
      </div>
      <div *ngIf="sellingPrice === 0">
        <canvas
          width="20"
          height="20"
          baseChart
          [data]="doughutChartDisableValue"
          [labels]=""
          [chartType]="doughnutChartType"
          [options]="doughutChartDisableOption"
          [colors]="doughnutDisableChartColors"
        >
        </canvas>
      </div>
    </div>
  </div>

  <div class="m-5 p-5" *ngIf="calcForm">
    <div>
      <form [formGroup]="calcForm">
        <ion-row>
          <ion-col>
            <ion-item color="light">
              <ion-label color="primary" position="floating"
                >{{'Buy Price' | translate}}</ion-label
              >
              <ion-avatar slot="end" class="ion-align-self-end pt-20"
                >{{this.currencySymbol}}</ion-avatar
              >
              <ion-input
                formControlName="buy_price"
                pkNumeric
                decimals="2"
                type="number"
                inputmode="numeric"
                (click)="sharedService.onClickInputClear('buy_price', this.calcForm)"
                id="buy_price"
                autofocus
              ></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col size="6">
            <ion-item color="light">
              <ion-label position="floating" color="primary"
                >{{'Transport' | translate}}
                ({{this.currencySymbol}})</ion-label
              >
              <ion-input
                formControlName="transport"
                pkNumeric
                decimals="2"
                type="number"
                id="transport"
                inputmode="numeric"
                (click)="sharedService.onClickInputClear('transport', this.calcForm)"
              ></ion-input>
            </ion-item>
            <ion-note class="ml-5" color="primary">
              {{'Total' | translate}}: {{this.currencySymbol}}
              {{this.totalWithTransport.toFixed(2)}}
            </ion-note>
          </ion-col>

          <ion-col size="6">
            <ion-item color="light">
              <ion-label position="floating" color="primary"
                >{{'Insurance' | translate}}
                ({{this.currencySymbol}})</ion-label
              >
              <ion-input
                formControlName="insurance"
                pkNumeric
                decimals="2"
                type="number"
                id="insurance"
                inputmode="numeric"
                (click)="sharedService.onClickInputClear('insurance', this.calcForm)"
              ></ion-input>
            </ion-item>
            <ion-note class="ml-5" color="primary">
              {{'Total' | translate}}: {{this.currencySymbol}}
              {{this.totalPrice.toFixed(2)}}
            </ion-note>
          </ion-col>
        </ion-row>
      </form>
      <ion-button
        (click)="openSaveProductModal()"
        class="mt-20"
        id="open-modal"
        *ngIf="this.sellingPrice"
        expand="block"
        >{{'Save Price' | translate}}</ion-button
      >
    </div>
  </div>

  <div class="mt-10 p-10 flex">
    <p class="color-danger" *ngIf="!savingPercent && !gstPercent">
      {{'saving_tax_warning' | translate}}
    </p>
  </div>
</ion-content>
<ion-modal [isOpen]="isProductModalOpen">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-icon
          slot="start"
          color="primary"
          class="fz-35 pl-10"
          (click)="cancel()"
          name="close-circle-outline"
        ></ion-icon>
        <ion-title class="ion-text-center"
          >{{'Product Name' | translate}}</ion-title
        >
        <ion-icon
          name="checkmark-circle-outline"
          slot="end"
          color="primary"
          class="fz-35 pr-10"
          (click)="confirm()"
        ></ion-icon>
      </ion-toolbar>
    </ion-header>
    <ion-content class="ion-padding">
      <ion-item>
        <ion-label color="primary" position="floating"
          >{{'Enter product name' | translate}}</ion-label
        >
        <ion-input type="text" [(ngModel)]="productName"></ion-input>
      </ion-item>
    </ion-content>
  </ng-template>
</ion-modal>
